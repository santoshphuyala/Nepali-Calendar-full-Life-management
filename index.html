<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Complete Nepali Calendar with Finance, Insurance, Vehicle, Subscription Management">
    <meta name="theme-color" content="#4A90E2">
    <title>Nepali Calendar 2082â€“2092 - Complete Manager</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='80'>ğŸ“…</text></svg>">
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="header-content">
            <h1>ğŸ“… Nepali Calendar</h1>
            <div class="header-dates">
                <div class="bs-date" id="headerBSDate">BS: Loading...</div>
                <div class="ad-date" id="headerADDate">AD: Loading...</div>
            </div>
        </div>
        <button class="today-btn" id="todayBtn">ğŸ“ Today</button>
    </header>

    <!-- Navigation Tabs -->
    <nav class="nav-tabs">
        <button class="nav-tab active" data-view="calendar">ğŸ“… Calendar</button>
        <button class="nav-tab" data-view="tracker">ğŸ’° Finance Tracker</button>
        <button class="nav-tab" data-view="financial">ğŸ’³ Financial Manager</button>
        <button class="nav-tab" data-view="assets">ğŸ›¡ï¸ Asset Manager</button>
        <button class="nav-tab" data-view="medicine" onclick="if(typeof initMedicineTracker==='function' && !this.dataset.initialized){initMedicineTracker();this.dataset.initialized='1';}">ğŸ’Š Medicine Tracker</button>
        <button class="nav-tab" data-view="notes">ğŸ“ Notes</button>
        <button class="nav-tab" data-view="settings">âš™ï¸ Settings</button>
    </nav>

    <!-- Main Container -->
    <main class="main-container">
        
        <!-- Calendar View -->
        <section id="calendarView" class="view active">
            <!-- View Switcher -->
            <div class="view-switcher">
                <button class="view-switch-btn" data-calendar-view="year">Year</button>
                <button class="view-switch-btn active" data-calendar-view="month">Month</button>
                <button class="view-switch-btn" data-calendar-view="week">Week</button>
                <button class="view-switch-btn" data-calendar-view="day">Day</button>
            </div>

            <!-- Calendar Controls -->
            <div class="calendar-controls">
                <button id="prevMonth">â—€</button>
                <div class="date-selector">
                    <select id="yearSelect"></select>
                    <select id="monthSelect"></select>
                </div>
                <button id="nextMonth">â–¶</button>
                
                <!-- Import and Export Buttons -->
                <div class="import-export-buttons">
                    <!-- Export Dropdown -->
                    <div class="dropdown-container">
                        <button class="btn-export" id="calendarExportBtn">
                            ğŸ“¤ Export
                        </button>
                        <div class="dropdown-menu" id="calendarExportMenu">
                            <button class="dropdown-item" onclick="exportCalendarData('monthly')">
                                ğŸ“„ Export Monthly Calendar
                            </button>
                            <button class="dropdown-item" onclick="exportCalendarData('yearly')">
                                ğŸ“… Export Yearly Calendar
                            </button>
                            <button class="dropdown-item" onclick="exportCalendarData('holidays')">
                                ğŸ‰ Export Yearly Holidays
                            </button>
                            <button class="dropdown-item" onclick="exportCalendarData('events')">
                                ğŸ“ Export All Events & Notes
                            </button>
                            <button class="dropdown-item" onclick="exportCalendarData('complete')">
                                ğŸ“¦ Export Complete Calendar
                            </button>
                        </div>
                    </div>
                    
                    <!-- Import Dropdown -->
                    <div class="dropdown-container">
                        <button class="btn-import" id="calendarImportBtn">
                            ğŸ“¥ Import
                        </button>
                        <div class="dropdown-menu" id="calendarImportMenu">
                            <button class="dropdown-item" onclick="document.getElementById('calendarImportMonthly').click()">
                                ğŸ“… Import Monthly Calendar
                            </button>
                            <button class="dropdown-item" onclick="document.getElementById('calendarImportYearly').click()">
                                ğŸ“… Import Yearly Calendar
                            </button>
                            <button class="dropdown-item" onclick="document.getElementById('calendarImportHolidays').click()">
                                ğŸ‰ Import Holidays
                            </button>
                            <button class="dropdown-item" onclick="document.getElementById('calendarImportEvents').click()">
                                ğŸ“ Import Events & Notes
                            </button>
                            <button class="dropdown-item" onclick="document.getElementById('calendarImportComplete').click()">
                                ğŸ“¦ Import Complete Calendar
                            </button>
                            <input type="file" id="calendarImportMonthly" accept=".json,.xlsx,.xls" style="display: none;" onchange="importCalendarData('monthly', this)">
                            <input type="file" id="calendarImportYearly" accept=".json,.xlsx,.xls" style="display: none;" onchange="importCalendarData('yearly', this)">
                            <input type="file" id="calendarImportHolidays" accept=".json,.xlsx,.xls" style="display: none;" onchange="importCalendarData('holidays', this)">
                            <input type="file" id="calendarImportEvents" accept=".json,.xlsx,.xls" style="display: none;" onchange="importCalendarData('events', this)">
                            <input type="file" id="calendarImportComplete" accept=".json,.xlsx,.xls" style="display: none;" onchange="importCalendarData('complete', this)">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Year View -->
            <div id="yearView" class="calendar-view-container">
                <div class="year-grid" id="yearGrid"></div>
                
                <!-- Yearly Holiday List -->
                <div class="yearly-holiday-list" id="yearlyHolidayList">
                    <h4>ğŸ‰ Yearly Holidays</h4>
                    <div id="yearlyHolidayContent"></div>
                </div>
                
                <!-- Yearly Summary -->
                <div class="yearly-summary" id="yearlySummary">
                    <h4>ğŸ“Š Yearly Summary</h4>
                    <div id="yearlySummaryContent"></div>
                </div>
            </div>

            <!-- Month View -->
            <div id="monthView" class="calendar-view-container active">
                <div class="calendar-grid" id="calendarGrid">
                    <div class="day-header">à¤†à¤‡à¤¤</div>
                    <div class="day-header">à¤¸à¥‹à¤®</div>
                    <div class="day-header">à¤®à¤‚à¤—à¤²</div>
                    <div class="day-header">à¤¬à¥à¤§</div>
                    <div class="day-header">à¤¬à¤¿à¤¹à¤¿</div>
                    <div class="day-header">à¤¶à¥à¤•à¥à¤°</div>
                    <div class="day-header saturday">à¤¶à¤¨à¤¿</div>
                </div>
                
                <!-- Monthly Holiday List -->
                <div class="monthly-holiday-list" id="monthlyHolidayList">
                    <h4>ğŸ‰ Monthly Holidays</h4>
                    <div id="monthlyHolidayContent"></div>
                </div>
                
                <!-- Monthly Notes List -->
                <div class="monthly-notes-list" id="monthlyNotesList">
                    <h4>ğŸ“ Monthly Notes & Events</h4>
                    <div id="monthlyNotesContent"></div>
                </div>
            </div>

            <!-- Week View -->
            <div id="weekView" class="calendar-view-container">
                <div class="week-grid" id="weekGrid"></div>
                
                <!-- Weekly Holiday List -->
                <div class="weekly-holiday-list" id="weeklyHolidayList">
                    <h4>ğŸ‰ Weekly Holidays</h4>
                    <div id="weeklyHolidayContent"></div>
                </div>
                
                <!-- Weekly Summary -->
                <div class="weekly-summary" id="weeklySummary">
                    <h4>ğŸ“Š Weekly Summary</h4>
                    <div id="weeklySummaryContent"></div>
                </div>
            </div>

            <!-- Day View -->
            <div id="dayView" class="calendar-view-container">
                <div class="day-detail" id="dayDetail"></div>
                
                <!-- Daily Summary -->
                <div class="daily-summary" id="dailySummary">
                    <h4>ğŸ“Š Daily Summary</h4>
                    <div id="dailySummaryContent"></div>
                </div>
            </div>

            <!-- Monthly Summary Dashboard -->
            <div class="dashboard">
                <h3>ğŸ“Š Monthly Summary</h3>
                <div class="summary-cards">
                    <div class="summary-card income">
                        <span class="label">Income</span>
                        <span class="value" id="monthlyIncome">Rs. 0</span>
                    </div>
                    <div class="summary-card expense">
                        <span class="label">Expenses</span>
                        <span class="value" id="monthlyExpense">Rs. 0</span>
                    </div>
                    <div class="summary-card savings">
                        <span class="label">Savings</span>
                        <span class="value" id="monthlySavings">Rs. 0</span>
                    </div>
                    <div class="summary-card budget">
                        <span class="label">Budget Left</span>
                        <span class="value" id="budgetRemaining">Rs. 0</span>
                    </div>
                </div>
                
                <!-- Charts Section -->
                <div class="charts-section">
                    <div class="chart-container">
                        <h4>Income vs Expense Trend</h4>
                        <canvas id="trendChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h4>Expense by Category</h4>
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Finance Tracker View (Combined Tracker & Budget) -->
        <section id="trackerView" class="view">
            <div class="tracker-header">
                <h2>ğŸ’° Finance Tracker</h2>
                <div class="tracker-actions">
                    <div class="action-group">
                        <button class="btn-primary" id="addIncomeBtn">+ Income</button>
                        <button class="btn-danger" id="addExpenseBtn">+ Expense</button>
                        <button class="btn-secondary" id="addRecurringBtn">ğŸ”„ Recurring</button>
                        <button class="btn-success" id="addBudgetBtn">+ Set Budget</button>
                    </div>
                    <div class="action-group">
                        <button class="btn-info" id="openSMSParserBtn" onclick="openSMSParser()">ğŸ“± SMS Parser</button>
                        <button class="btn-warning" id="processSMSBtn" onclick="processPendingSMSTransactions()">ğŸ”„ Process SMS</button>
                    </div>
                    
                    <!-- Import and Export Buttons -->
                    <div class="import-export-buttons">
                        <!-- Export Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-export" id="trackerExportBtn">
                                ğŸ“¤ Export
                            </button>
                            <div class="dropdown-menu" id="trackerExportMenu">
                                <div class="dropdown-section">
                                    <h5>ğŸ’° Transactions</h5>
                                    <button class="dropdown-item" onclick="exportTrackerData('income')">
                                        ğŸ’µ Export Income Only
                                    </button>
                                    <button class="dropdown-item" onclick="exportTrackerData('expenses')">
                                        ğŸ’¸ Export Expenses Only
                                    </button>
                                    <button class="dropdown-item" onclick="exportTrackerData('recurring')">
                                        ğŸ”„ Export Recurring Transactions
                                    </button>
                                    <button class="dropdown-item" onclick="exportTrackerData('monthly')">
                                        ğŸ“Š Export Monthly Summary
                                    </button>
                                    <button class="dropdown-item" onclick="exportTrackerData('complete')">
                                        ğŸ“¦ Export Complete Tracker
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ“Š Budget</h5>
                                    <button class="dropdown-item" onclick="exportData('budget', 'json')">
                                        ğŸ“„ Export Budget as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('budget', 'excel')">
                                        ğŸ“Š Export Budget as Excel
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ“¦ Complete Finance</h5>
                                    <button class="dropdown-item" onclick="exportData('finance', 'json')">
                                        ğŸ“„ Export All as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('finance', 'excel')">
                                        ğŸ“Š Export All as Excel
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Import Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-import" id="trackerImportBtn">
                                ğŸ“¥ Import
                            </button>
                            <div class="dropdown-menu" id="trackerImportMenu">
                                <div class="dropdown-section">
                                    <h5>ğŸ’° Transactions</h5>
                                    <button class="dropdown-item" onclick="document.getElementById('trackerImportIncome').click()">
                                        ğŸ’µ Import Income
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('trackerImportExpenses').click()">
                                        ğŸ’¸ Import Expenses
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('trackerImportRecurring').click()">
                                        ğŸ”„ Import Recurring
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('trackerImportComplete').click()">
                                        ğŸ“¦ Import Complete Tracker
                                    </button>
                                    <input type="file" id="trackerImportIncome" accept=".json,.xlsx,.xls" style="display: none;" onchange="importTrackerData('income', this)">
                                    <input type="file" id="trackerImportExpenses" accept=".json,.xlsx,.xls" style="display: none;" onchange="importTrackerData('expenses', this)">
                                    <input type="file" id="trackerImportRecurring" accept=".json,.xlsx,.xls" style="display: none;" onchange="importTrackerData('recurring', this)">
                                    <input type="file" id="trackerImportComplete" accept=".json,.xlsx,.xls" style="display: none;" onchange="importTrackerData('complete', this)">
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ“Š Budget</h5>
                                    <button class="dropdown-item" onclick="document.getElementById('budgetImportFile').click()">
                                        ğŸ“„ Import Budget from JSON
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('budgetImportExcel').click()">
                                        ğŸ“Š Import Budget from Excel
                                    </button>
                                    <input type="file" id="budgetImportFile" accept=".json" style="display: none;" onchange="importData('budget', 'json', this)">
                                    <input type="file" id="budgetImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importData('budget', 'excel', this)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Finance Summary Dashboard -->
            <div class="finance-summary">
                <div class="summary-row">
                    <div class="summary-card-finance transactions-summary">
                        <h4>ğŸ’° Transactions</h4>
                        <div class="metric">
                            <span class="label">Monthly Income</span>
                            <span class="value income" id="monthlyIncome">Rs. 0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Monthly Expenses</span>
                            <span class="value expense" id="monthlyExpense">Rs. 0</span>
                        </div>
                    </div>
                    
                    <div class="summary-card-finance budget-summary">
                        <h4>ğŸ“Š Budget</h4>
                        <div class="metric">
                            <span class="label">Budget Total</span>
                            <span class="value" id="budgetTotal">Rs. 0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Budget Used</span>
                            <span class="value" id="budgetPercentage">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module Tabs -->
            <div class="module-tabs">
                <button class="module-tab active" data-module="transactions">ğŸ’° Transactions</button>
                <button class="module-tab" data-module="budget">ğŸ“Š Budget</button>
                <button class="module-tab" data-module="smsParser">ğŸ“± SMS Parser</button>
            </div>

            <!-- Transactions Module -->
            <div id="transactionsModule" class="finance-module active">
                <div class="filter-section">
                    <select id="trackerFilter">
                        <option value="all">All Transactions</option>
                        <option value="income">Income Only</option>
                        <option value="expense">Expense Only</option>
                        <option value="recurring">Recurring Only</option>
                    </select>
                    <input type="month" id="trackerMonth" class="month-filter">
                    <select id="currencyFilter">
                        <option value="NPR">NPR (à¤°à¥‚)</option>
                        <option value="USD">USD ($)</option>
                        <option value="EUR">EUR (â‚¬)</option>
                        <option value="INR">INR (â‚¹)</option>
                    </select>
                </div>

                <div class="recurring-section" id="recurringSection">
                    <h3>ğŸ”„ Recurring Transactions</h3>
                    <div id="recurringList"></div>
                </div>

                <div class="tracker-list" id="trackerList"></div>
            </div>

            <!-- Budget Module -->
            <div id="budgetModule" class="finance-module">
                <div class="budget-overview">
                    <div class="budget-summary-card">
                        <h3>Current Month Budget</h3>
                        <div class="budget-progress">
                            <div class="progress-info">
                                <span>Spent: <strong id="budgetSpent">Rs. 0</strong></span>
                                <span>Budget: <strong id="budgetTotal">Rs. 0</strong></span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="budgetProgress"></div>
                            </div>
                            <div class="progress-percentage" id="budgetPercentage">0%</div>
                        </div>
                    </div>
                </div>

                <div class="budget-categories" id="budgetCategories"></div>

                <div class="budget-chart-container">
                    <h3>Budget vs Actual</h3>
                    <canvas id="budgetChart"></canvas>
                </div>
            </div>

            <!-- SMS Parser Module -->
            <div id="smsParserModule" class="finance-module">
                <div class="sms-parser-header">
                    <h3>ğŸ“± SMS Transaction Parser</h3>
                    <p>Parse bank SMS messages and automatically add them as income/expense transactions</p>
                </div>

                <div class="sms-input-section">
                    <div class="form-group">
                        <label for="smsInput">Paste Bank SMS Message:</label>
                        <textarea id="smsInput" class="form-control" rows="4" placeholder="Paste your bank SMS message here..."></textarea>
                    </div>
                    
                    <div class="sms-parse-preview" id="smsParsePreview" style="display: none;">
                        <h4>ğŸ“Š Parsed Transaction Details:</h4>
                        <div class="parsed-details" id="parsedDetails"></div>
                    </div>

                    <div class="sms-actions">
                        <button class="btn btn-primary" onclick="parseAndPreviewSMS()">
                            <i class="fas fa-search"></i> Parse SMS
                        </button>
                        <button class="btn btn-success" id="addParsedTransactionBtn" onclick="addParsedTransaction()" style="display: none;">
                            <i class="fas fa-plus"></i> Add as Transaction
                        </button>
                        <button class="btn btn-secondary" onclick="clearSMSInput()">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                        <button class="btn btn-info" onclick="readClipboardSMS()">
                            <i class="fas fa-clipboard"></i> Read from Clipboard
                        </button>
                    </div>
                </div>

                <div class="sms-instructions">
                    <h4>ğŸ“– Instructions:</h4>
                    <ul>
                        <li>Paste any bank SMS message containing transaction details</li>
                        <li>The parser will automatically extract amount, type, bank, date, and description</li>
                        <li>Review the parsed details and click "Add as Transaction" to save</li>
                        <li>Supported banks: Nabil, Global IME, Sanima, NIC Asia, Himalayan, eSewa, Khalti, and more</li>
                    </ul>
                </div>

                <div class="recent-sms-transactions" id="recentSmsTransactions">
                    <h4>ğŸ“‹ Recent SMS Transactions</h4>
                    <div id="recentSmsList"></div>
                </div>
            </div>
        </section>

        <!-- Financial Manager View (Combined Bills, Goals & Subscriptions) -->
        <section id="financialView" class="view">
            <div class="financial-header">
                <h2>ğŸ’³ Financial Manager</h2>
                <div class="financial-actions">
                    <div class="action-group">
                        <button class="btn-primary" id="addBillBtn">+ Add Bill</button>
                        <button class="btn-success" id="addGoalBtn">+ New Goal</button>
                        <button class="btn-info" id="addSubscriptionBtn">+ Add Subscription</button>
                        <button class="btn-warning" id="addShoppingBtn">+ Add Shopping Item</button>
                        <button class="btn-secondary" id="addCustomTypeBtn">+ New Custom Type</button>
                    </div>
                    
                    <!-- Import and Export Buttons -->
                    <div class="import-export-buttons">
                        <!-- Export Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-export" id="financialExportBtn">
                                ğŸ“¤ Export
                            </button>
                            <div class="dropdown-menu" id="financialExportMenu">
                                <div class="dropdown-section">
                                    <h5>ğŸ’³ Bills</h5>
                                    <button class="dropdown-item" onclick="exportData('bills', 'json')">
                                        ğŸ“„ Export Bills as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('bills', 'excel')">
                                        ğŸ“Š Export Bills as Excel
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ¯ Goals</h5>
                                    <button class="dropdown-item" onclick="exportData('goals', 'json')">
                                        ğŸ“„ Export Goals as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('goals', 'excel')">
                                        ğŸ“Š Export Goals as Excel
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ“º Subscriptions</h5>
                                    <button class="dropdown-item" onclick="exportData('subscription', 'json')">
                                        ğŸ“„ Export Subscriptions as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('subscription', 'excel')">
                                        ğŸ“Š Export Subscriptions as Excel
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ›’ Shopping</h5>
                                    <button class="dropdown-item" onclick="exportData('shopping', 'json')">
                                        ğŸ“„ Export Shopping as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('shopping', 'excel')">
                                        ğŸ“Š Export Shopping as Excel
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ“‹ Custom Data</h5>
                                    <button class="dropdown-item" onclick="exportData('custom', 'json')">
                                        ğŸ“„ Export Custom as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('custom', 'excel')">
                                        ğŸ“Š Export Custom as Excel
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ“¦ Complete Financial</h5>
                                    <button class="dropdown-item" onclick="exportData('financial', 'json')">
                                        ğŸ“„ Export All as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('financial', 'excel')">
                                        ğŸ“Š Export All as Excel
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Import Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-import" id="financialImportBtn">
                                ğŸ“¥ Import
                            </button>
                            <div class="dropdown-menu" id="financialImportMenu">
                                <div class="dropdown-section">
                                    <h5>ğŸ’³ Bills</h5>
                                    <button class="dropdown-item" onclick="document.getElementById('billsImportFile').click()">
                                        ğŸ“„ Import Bills from JSON
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('billsImportExcel').click()">
                                        ğŸ“Š Import Bills from Excel
                                    </button>
                                    <input type="file" id="billsImportFile" accept=".json" style="display: none;" onchange="importData('bills', 'json', this)">
                                    <input type="file" id="billsImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importData('bills', 'excel', this)">
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ¯ Goals</h5>
                                    <button class="dropdown-item" onclick="document.getElementById('goalsImportFile').click()">
                                        ğŸ“„ Import Goals from JSON
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('goalsImportExcel').click()">
                                        ğŸ“Š Import Goals from Excel
                                    </button>
                                    <input type="file" id="goalsImportFile" accept=".json" style="display: none;" onchange="importData('goals', 'json', this)">
                                    <input type="file" id="goalsImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importData('goals', 'excel', this)">
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ›’ Shopping</h5>
                                    <button class="dropdown-item" onclick="document.getElementById('shoppingImportFile').click()">
                                        ğŸ“„ Import Shopping from JSON
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('shoppingImportExcel').click()">
                                        ğŸ“Š Import Shopping from Excel
                                    </button>
                                    <input type="file" id="shoppingImportFile" accept=".json" style="display: none;" onchange="importData('shopping', 'json', this)">
                                    <input type="file" id="shoppingImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importData('shopping', 'excel', this)">
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ“‹ Custom Data</h5>
                                    <button class="dropdown-item" onclick="document.getElementById('customImportFile').click()">
                                        ğŸ“„ Import Custom from JSON
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('customImportExcel').click()">
                                        ğŸ“Š Import Custom from Excel
                                    </button>
                                    <input type="file" id="customImportFile" accept=".json" style="display: none;" onchange="importData('custom', 'json', this)">
                                    <input type="file" id="customImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importData('custom', 'excel', this)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Financial Summary Dashboard -->
            <div class="financial-summary">
                <div class="summary-row">
                    <div class="summary-card-financial bills-summary">
                        <h4>ğŸ’³ Bills</h4>
                        <div class="metric">
                            <span class="label">Pending</span>
                            <span class="value" id="pendingBillsCount">0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Overdue</span>
                            <span class="value overdue" id="overdueBillsCount">0</span>
                        </div>
                    </div>
                    
                    <div class="summary-card-financial goals-summary">
                        <h4>ğŸ¯ Goals</h4>
                        <div class="metric">
                            <span class="label">Active Goals</span>
                            <span class="value" id="activeGoalsCount">0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Total Saved</span>
                            <span class="value" id="totalGoalsSaved">Rs. 0</span>
                        </div>
                    </div>
                    
                    <div class="summary-card-financial subscriptions-summary">
                        <h4>ğŸ“º Subscriptions</h4>
                        <div class="metric">
                            <span class="label">Monthly Cost</span>
                            <span class="value" id="monthlySubCost">Rs. 0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Annual Cost</span>
                            <span class="value" id="annualSubCost">Rs. 0</span>
                        </div>
                    </div>
                    
                    <div class="summary-card-financial shopping-summary">
                        <h4>ğŸ›’ Shopping</h4>
                        <div class="metric">
                            <span class="label">Pending Items</span>
                            <span class="value" id="pendingShoppingCount">0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Total Budget</span>
                            <span class="value" id="shoppingBudget">Rs. 0</span>
                        </div>
                    </div>
                    
                    <div class="summary-card-financial custom-summary">
                        <h4>ğŸ“‹ Custom Data</h4>
                        <div class="metric">
                            <span class="label">Custom Types</span>
                            <span class="value" id="customTypesCount">0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Total Items</span>
                            <span class="value" id="customItemsCount">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module Tabs -->
            <div class="module-tabs">
                <button class="module-tab active" data-module="bills">ğŸ’³ Bills</button>
                <button class="module-tab" data-module="goals">ğŸ¯ Goals</button>
                <button class="module-tab" data-module="subscriptions">ğŸ“º Subscriptions</button>
                <button class="module-tab" data-module="shopping">ğŸ›’ Shopping</button>
                <button class="module-tab" data-module="custom">ğŸ“‹ Custom</button>
            </div>

            <!-- Bills Module -->
            <div id="billsModule" class="financial-module active">
                <div class="upcoming-bills">
                    <h3>â° Upcoming Bills</h3>
                    <div id="upcomingBillsList"></div>
                </div>

                <div class="filter-section">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="pending">Pending</button>
                    <button class="filter-btn" data-filter="paid">Paid</button>
                    <button class="filter-btn" data-filter="overdue">Overdue</button>
                </div>

                <div class="bills-list" id="billsList"></div>
            </div>

            <!-- Goals Module -->
            <div id="goalsModule" class="financial-module">
                <div class="goals-grid" id="goalsGrid"></div>
            </div>

            <!-- Subscriptions Module -->
            <div id="subscriptionsModule" class="financial-module">
                <div class="filter-section">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="active">Active</button>
                    <button class="filter-btn" data-filter="paused">Paused</button>
                    <button class="filter-btn" data-filter="cancelled">Cancelled</button>
                </div>

                <div class="subscription-list" id="subscriptionList"></div>
            </div>

            <!-- Shopping Module -->
            <div id="shoppingModule" class="financial-module">
                <div class="filter-section">
                    <button class="filter-btn active" data-filter="pending">Pending</button>
                    <button class="filter-btn" data-filter="purchased">Purchased</button>
                    <button class="filter-btn" data-filter="all">All</button>
                </div>

                <div class="shopping-list" id="shoppingList"></div>
            </div>

            <!-- Custom Module -->
            <div id="customModule" class="financial-module">
                <div class="custom-types" id="customTypes"></div>
                <div class="custom-items" id="customItems"></div>
            </div>
        </section>

        <!-- Asset Manager View (Combined Insurance & Vehicle) -->
        <section id="assetsView" class="view">
            <div class="assets-header">
                <h2>ğŸ›¡ï¸ Asset Manager</h2>
                <div class="assets-actions">
                    <div class="action-group">
                        <button class="btn-primary" id="addInsuranceBtn">+ Add Policy</button>
                        <button class="btn-success" id="addVehicleBtn">+ Add Vehicle</button>
                    </div>
                    
                    <!-- Import and Export Buttons -->
                    <div class="import-export-buttons">
                        <!-- Export Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-export" id="assetsExportBtn">
                                ğŸ“¤ Export
                            </button>
                            <div class="dropdown-menu" id="assetsExportMenu">
                                <div class="dropdown-section">
                                    <h5>ğŸ›¡ï¸ Insurance</h5>
                                    <button class="dropdown-item" onclick="exportData('insurance', 'json')">
                                        ğŸ“„ Export Insurance as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('insurance', 'excel')">
                                        ğŸ“Š Export Insurance as Excel
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸš— Vehicles</h5>
                                    <button class="dropdown-item" onclick="exportData('vehicle', 'json')">
                                        ğŸ“„ Export Vehicles as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('vehicle', 'excel')">
                                        ğŸ“Š Export Vehicles as Excel
                                    </button>
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸ“¦ Complete Assets</h5>
                                    <button class="dropdown-item" onclick="exportData('assets', 'json')">
                                        ğŸ“„ Export All as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportData('assets', 'excel')">
                                        ğŸ“Š Export All as Excel
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Import Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-import" id="assetsImportBtn">
                                ğŸ“¥ Import
                            </button>
                            <div class="dropdown-menu" id="assetsImportMenu">
                                <div class="dropdown-section">
                                    <h5>ğŸ›¡ï¸ Insurance</h5>
                                    <button class="dropdown-item" onclick="document.getElementById('insuranceImportFile').click()">
                                        ğŸ“„ Import Insurance from JSON
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('insuranceImportExcel').click()">
                                        ğŸ“Š Import Insurance from Excel
                                    </button>
                                    <input type="file" id="insuranceImportFile" accept=".json" style="display: none;" onchange="importData('insurance', 'json', this)">
                                    <input type="file" id="insuranceImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importData('insurance', 'excel', this)">
                                </div>
                                <div class="dropdown-section">
                                    <h5>ğŸš— Vehicles</h5>
                                    <button class="dropdown-item" onclick="document.getElementById('vehicleImportFile').click()">
                                        ğŸ“„ Import Vehicles from JSON
                                    </button>
                                    <button class="dropdown-item" onclick="document.getElementById('vehicleImportExcel').click()">
                                        ğŸ“Š Import Vehicles from Excel
                                    </button>
                                    <input type="file" id="vehicleImportFile" accept=".json" style="display: none;" onchange="importData('vehicle', 'json', this)">
                                    <input type="file" id="vehicleImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importData('vehicle', 'excel', this)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Asset Summary Dashboard -->
            <div class="assets-summary">
                <div class="summary-row">
                    <div class="summary-card-assets insurance-summary">
                        <h4>ğŸ›¡ï¸ Insurance</h4>
                        <div class="metric">
                            <span class="label">Total Policies</span>
                            <span class="value" id="totalPolicies">0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Annual Premium</span>
                            <span class="value" id="totalPremium">Rs. 0</span>
                        </div>
                    </div>
                    
                    <div class="summary-card-assets vehicle-summary">
                        <h4>ğŸš— Vehicles</h4>
                        <div class="metric">
                            <span class="label">Total Vehicles</span>
                            <span class="value" id="totalVehicles">0</span>
                        </div>
                        <div class="metric">
                            <span class="label">Active Vehicles</span>
                            <span class="value" id="activeVehicles">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module Tabs -->
            <div class="module-tabs">
                <button class="module-tab active" data-module="insurance">ğŸ›¡ï¸ Insurance</button>
                <button class="module-tab" data-module="vehicles">ğŸš— Vehicles</button>
            </div>

            <!-- Insurance Module -->
            <div id="insuranceModule" class="asset-module active">
                <div class="insurance-stats">
                    <div class="stat-card">
                        <span class="stat-label">Total Policies</span>
                        <span class="stat-value" id="totalPolicies">0</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Active Policies</span>
                        <span class="stat-value" id="activePolicies">0</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Annual Premium</span>
                        <span class="stat-value" id="totalPremium">Rs. 0</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Expiring Soon</span>
                        <span class="stat-value" id="expiringSoon">0</span>
                    </div>
                </div>

                <div class="filter-section">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="life">Life</button>
                    <button class="filter-btn" data-filter="health">Health</button>
                    <button class="filter-btn" data-filter="vehicle">Vehicle</button>
                    <button class="filter-btn" data-filter="property">Property</button>
                </div>

                <div class="insurance-list" id="insuranceList"></div>
            </div>

            <!-- Vehicles Module -->
            <div id="vehiclesModule" class="asset-module">
                <div class="vehicle-grid" id="vehicleGrid"></div>
            </div>
        </section>



        <!-- Notes View -->
        <section id="notesView" class="view">
            <div class="notes-header">
                <h2>ğŸ“ Notes & Reminders</h2>
                <div class="notes-actions">
                    <button class="btn-primary" id="addNoteBtn">+ Add Note</button>
                    
                    <!-- Import and Export Buttons -->
                    <div class="import-export-buttons">
                        <!-- Export Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-export" id="notesExportBtn">
                                ğŸ“¤ Export
                            </button>
                            <div class="dropdown-menu" id="notesExportMenu">
                                <button class="dropdown-item" onclick="exportData('notes', 'json')">
                                    ğŸ“„ Export as JSON
                                </button>
                                <button class="dropdown-item" onclick="exportData('notes', 'excel')">
                                    ğŸ“Š Export as Excel
                                </button>
                            </div>
                        </div>
                        
                        <!-- Import Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-import" id="notesImportBtn">
                                ğŸ“¥ Import
                            </button>
                            <div class="dropdown-menu" id="notesImportMenu">
                                <button class="dropdown-item" onclick="document.getElementById('notesImportFile').click()">
                                    ğŸ“„ Import from JSON
                                </button>
                                <button class="dropdown-item" onclick="document.getElementById('notesImportExcel').click()">
                                    ğŸ“Š Import from Excel
                                </button>
                                <input type="file" id="notesImportFile" accept=".json" style="display: none;" onchange="importData('notes', 'json', this)">
                                <input type="file" id="notesImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importData('notes', 'excel', this)">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="upcoming-reminders" id="upcomingReminders">
                <h3>ğŸ”” Upcoming Reminders</h3>
                <div id="remindersList"></div>
            </div>

            <div class="notes-list" id="notesList"></div>
        </section>

        <!-- Medicine Tracker View -->
        <section id="medicineView" class="view">
            <div class="medicine-header">
                <h2>ğŸ’Š Medicine Tracker</h2>
                <div class="medicine-actions">
                    <div class="action-group">
                        <button class="btn-primary" id="addMedicineBtn">+ Add Medicine</button>
                        <button class="btn-info" id="addFamilyMemberBtn">+ Add Family Member</button>
                    </div>
                    
                    <!-- Import and Export Buttons -->
                    <div class="import-export-buttons">
                        <!-- Export Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-export" id="medicineExportBtn">
                                ğŸ“¤ Export
                            </button>
                            <div class="dropdown-menu" id="medicineExportMenu">
                                <div class="dropdown-section">
                                    <h5>ğŸ’Š Medicine Data</h5>
                                    <button class="dropdown-item" onclick="exportMedicineData('medicines')">
                                        ğŸ“„ Export Medicines as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportMedicineData('medicines', 'excel')">
                                        ğŸ“Š Export Medicines as Excel
                                    </button>
                                    <button class="dropdown-item" onclick="exportMedicineData('family')">
                                        ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Export Family Members as JSON
                                    </button>
                                    <button class="dropdown-item" onclick="exportMedicineData('complete')">
                                        ğŸ“¦ Export Complete Medicine Data
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Import Dropdown -->
                        <div class="dropdown-container">
                            <button class="btn-import" id="medicineImportBtn">
                                ğŸ“¥ Import
                            </button>
                            <div class="dropdown-menu" id="medicineImportMenu">
                                <button class="dropdown-item" onclick="document.getElementById('medicineImportFile').click()">
                                    ğŸ“„ Import Medicines from JSON
                                </button>
                                <button class="dropdown-item" onclick="document.getElementById('medicineImportExcel').click()">
                                    ğŸ“Š Import Medicines from Excel
                                </button>
                                <input type="file" id="medicineImportFile" accept=".json" style="display: none;" onchange="importMedicineData('json', this)">
                                <input type="file" id="medicineImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importMedicineData('excel', this)">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module Tabs -->
            <div class="module-tabs">
                <button class="module-tab active" data-module="medicines">ğŸ’Š Medicines</button>
                <button class="module-tab" data-module="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Family Members</button>
                <button class="module-tab" data-module="schedule">â° Schedule</button>
                <button class="module-tab" data-module="prescriptions">ğŸ“‹ Prescriptions</button>
            </div>

            <!-- Medicines Module -->
            <div id="medicinesModule" class="medicine-module active">
                <div class="medicine-filters">
                    <select id="medicineFilter">
                        <option value="all">All Medicines</option>
                        <option value="active">Active</option>
                        <option value="completed">Completed</option>
                        <option value="expired">Expired</option>
                    </select>
                    <select id="memberFilter">
                        <option value="all">All Family Members</option>
                    </select>
                    <input type="text" id="medicineSearch" placeholder="Search medicines...">
                </div>

                <div class="medicine-stats">
                    <div class="stat-card">
                        <h4>Active Medicines</h4>
                        <span id="activeMedicinesCount">0</span>
                    </div>
                    <div class="stat-card">
                        <h4>Today's Doses</h4>
                        <span id="todayDosesCount">0</span>
                    </div>
                    <div class="stat-card">
                        <h4>Expiring Soon</h4>
                        <span id="expiringCount">0</span>
                    </div>
                </div>

                <div class="medicine-list" id="medicineList"></div>
            </div>

            <!-- Family Members Module -->
            <div id="familyModule" class="medicine-module">
                <div class="family-members-list" id="familyMembersList"></div>
            </div>

            <!-- Schedule Module -->
            <div id="scheduleModule" class="medicine-module">
                <div class="schedule-view">
                    <div class="schedule-header">
                        <h3>Today's Medicine Schedule</h3>
                        <div class="schedule-date" id="scheduleDate"></div>
                    </div>
                    <div class="schedule-list" id="scheduleList"></div>
                </div>
            </div>

            <!-- Prescriptions Module -->
            <div id="prescriptionsModule" class="medicine-module">
                <div class="prescriptions-list" id="prescriptionsList"></div>
            </div>
        </section>

        <!-- Settings View -->
        <section id="settingsView" class="view">
            <div class="settings-container">
                <h2>âš™ï¸ Settings</h2>

                <!-- Theme Toggle -->
                <div class="setting-item">
                    <label>
                        <input type="checkbox" id="darkModeToggle">
                        <span>ğŸŒ™ Dark Mode</span>
                    </label>
                </div>

                <!-- Holiday Management -->
                <div class="setting-section">
                    <h3>ğŸ‰ Holiday Management</h3>
                    <div class="holiday-controls">
                        <button class="btn-primary" id="addHolidayBtn">+ Add Holiday</button>
                        <button class="btn-secondary" id="importHolidayBtn">ğŸ“¥ Import CSV</button>
                        <button class="btn-warning" id="removeDuplicateHolidaysBtn">ğŸ—‘ï¸ Remove Duplicates</button>
                        <input type="file" id="holidayFileInput" accept=".csv" hidden>
                    </div>
                    <div class="holiday-list" id="holidayList"></div>
                </div>

                <!-- Data Management -->
                <div class="setting-section">
                    <h3>ğŸ’¾ Data Management</h3>
                    
                    <!-- Global Duplicate Detection -->
                    <div class="duplicate-management">
                        <h4>ğŸ” Duplicate Detection</h4>
                        <div class="button-group">
                            <button class="btn-warning" id="globalDuplicateScanBtn">
                                ğŸ” Scan All Modules for Duplicates
                            </button>
                        </div>
                        <div id="duplicateScanResults" class="duplicate-results" style="display: none;">
                            <!-- Results will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Overall Import/Export -->
                    <div class="import-export-group">
                        <h4>ğŸŒ Overall Data</h4>
                        <div class="button-group">
                            <div class="import-export-dropdown">
                                <button class="import-export-btn" id="overallExportBtn">
                                    ğŸ“¤ Export All Data
                                </button>
                                <div class="dropdown-menu" id="overallExportMenu">
                                    <div class="dropdown-section">
                                        <h5>ğŸ“¤ Export Format</h5>
                                        <button class="dropdown-item" onclick="exportAllData('json')">
                                            ğŸ“„ Export Complete as JSON
                                        </button>
                                        <button class="dropdown-item" onclick="exportAllData('excel')">
                                            ğŸ“Š Export Complete as Excel
                                        </button>
                                        <button class="dropdown-item" onclick="exportAllData('csv')">
                                            ğŸ“‹ Export Complete as CSV
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="import-export-dropdown">
                                <button class="import-export-btn" id="overallImportBtn">
                                    ğŸ“¥ Import Data
                                </button>
                                <div class="dropdown-menu" id="overallImportMenu">
                                    <div class="dropdown-section">
                                        <h5>ğŸ“¥ Import Format</h5>
                                        <button class="dropdown-item" onclick="document.getElementById('overallImportJson').click()">
                                            ğŸ“„ Import from JSON
                                        </button>
                                        <button class="dropdown-item" onclick="document.getElementById('overallImportExcel').click()">
                                            ğŸ“Š Import from Excel
                                        </button>
                                        <button class="dropdown-item" onclick="document.getElementById('overallImportCsv').click()">
                                            ğŸ“‹ Import from CSV
                                        </button>
                                        <input type="file" id="overallImportJson" accept=".json" style="display: none;" onchange="importAllData('json', this)">
                                        <input type="file" id="overallImportExcel" accept=".xlsx,.xls" style="display: none;" onchange="importAllData('excel', this)">
                                        <input type="file" id="overallImportCsv" accept=".csv" style="display: none;" onchange="importAllData('csv', this)">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Module-specific Import/Export -->
                    <div class="import-export-group">
                        <h4>ğŸ“¦ Module-specific Data</h4>
                        <div class="module-grid">
                            <div class="import-export-dropdown">
                                <button class="import-export-btn small" id="calendarDataBtn">
                                    ğŸ“… Calendar
                                </button>
                                <div class="dropdown-menu" id="calendarDataMenu">
                                    <button class="dropdown-item" onclick="exportModuleData('calendar', 'json')">ğŸ“„ JSON</button>
                                    <button class="dropdown-item" onclick="exportModuleData('calendar', 'excel')">ğŸ“Š Excel</button>
                                    <button class="dropdown-item" onclick="document.getElementById('calendarModuleImport').click()">ğŸ“¥ Import</button>
                                    <input type="file" id="calendarModuleImport" accept=".json,.xlsx,.xls" style="display: none;" onchange="importModuleData('calendar', this)">
                                </div>
                            </div>
                            
                            <div class="import-export-dropdown">
                                <button class="import-export-btn small" id="financeDataBtn">
                                    ğŸ’° Finance Tracker
                                </button>
                                <div class="dropdown-menu" id="financeDataMenu">
                                    <button class="dropdown-item" onclick="exportModuleData('finance', 'json')">ğŸ“„ JSON</button>
                                    <button class="dropdown-item" onclick="exportModuleData('finance', 'excel')">ğŸ“Š Excel</button>
                                    <button class="dropdown-item" onclick="document.getElementById('financeModuleImport').click()">ğŸ“¥ Import</button>
                                    <input type="file" id="financeModuleImport" accept=".json,.xlsx,.xls" style="display: none;" onchange="importModuleData('finance', this)">
                                </div>
                            </div>
                            
                            <div class="import-export-dropdown">
                                <button class="import-export-btn small" id="assetsDataBtn">
                                    ğŸ›¡ï¸ Asset Manager
                                </button>
                                <div class="dropdown-menu" id="assetsDataMenu">
                                    <button class="dropdown-item" onclick="exportModuleData('assets', 'json')">ğŸ“„ JSON</button>
                                    <button class="dropdown-item" onclick="exportModuleData('assets', 'excel')">ğŸ“Š Excel</button>
                                    <button class="dropdown-item" onclick="document.getElementById('assetsModuleImport').click()">ğŸ“¥ Import</button>
                                    <input type="file" id="assetsModuleImport" accept=".json,.xlsx,.xls" style="display: none;" onchange="importModuleData('assets', this)">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Data Operations -->
                    <div class="data-operations">
                        <h4>âš™ï¸ Data Operations</h4>
                        <div class="button-group">
                            <button class="btn-secondary" id="backupDataBtn">â˜ï¸ Backup to Cloud</button>
                            <button class="btn-secondary" id="restoreDataBtn">ğŸ”„ Restore from Backup</button>
                            <button class="btn-danger" id="clearDataBtn">ğŸ—‘ï¸ Clear All Data</button>
                        </div>
                    </div>
                </div>

                <!-- App Info -->
                <div class="setting-section">
                    <h3>â„¹ï¸ About</h3>
                    <p><strong>App:</strong> Nepali Calendar 2082â€“2092 Complete Manager</p>
                    <p><strong>Version:</strong> 2.0.0</p>
                    <p><strong>Modules:</strong> Calendar, Finance, Insurance, Vehicle, Subscriptions, Custom Data</p>
                    <p><strong>Developer:</strong> Santosh Phuyal</p>
                    <p><strong>Email:</strong> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9df5f4eefcf3e9f2eef5edf5e8e4fcf1ddfaf0fcf4f1b3fef2f0">[email&#160;protected]</a></p>
                </div>
            </div>
        </section>

    </main>

    <!-- Floating Action Button -->
    <div class="fab" id="fab">
        <button class="fab-button">+</button>
        <div class="fab-menu" id="fabMenu">
            <button class="fab-item" data-action="income">ğŸ’µ Income</button>
            <button class="fab-item" data-action="expense">ğŸ’¸ Expense</button>
            <button class="fab-item" data-action="note">ğŸ“ Note</button>
            <button class="fab-item" data-action="shopping">ğŸ›’ Shopping</button>
            <button class="fab-item" data-action="insurance">ğŸ›¡ï¸ Insurance</button>
            <button class="fab-item" data-action="vehicle">ğŸš— Vehicle</button>
        </div>
    </div>

    <!-- Modal Container -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h3 id="modalTitle"></h3>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Date Detail Drawer -->
    <div class="drawer" id="dateDrawer">
        <div class="drawer-content">
            <div class="drawer-header">
                <h3 id="drawerTitle">Date Details</h3>
                <button class="drawer-close">&times;</button>
            </div>
            <div class="drawer-body" id="drawerBody"></div>
        </div>
    </div>

        <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="conversion.js"></script>
    <script src="db.js"></script>
    <script src="charts.js"></script>
    <script src="budget.js"></script>
    <script src="insurance.js"></script>
    <script src="vehicle.js"></script>
    <script src="subscription.js"></script>
    <script src="custom.js"></script>
    <script src="import-export.js"></script>
    <script src="medicine-tracker.js"></script>
    <script>
        // Wire medicine tracker buttons as soon as the script is loaded.
        // Works regardless of which nav-tab is active on load.
        document.addEventListener('DOMContentLoaded', function () {
            // Patch the nav-tab click so initMedicineTracker runs on first activation
            const medicineNavTab = document.querySelector('[data-view="medicine"]');
            if (medicineNavTab) {
                const _orig = medicineNavTab.onclick;
                medicineNavTab.onclick = function (e) {
                    if (_orig) _orig.call(this, e);
                    if (typeof initMedicineTracker === 'function' && !this._medInit) {
                        this._medInit = true;
                        initMedicineTracker();
                    }
                };
            }
        });
    </script>
    <script src="nepali-date-picker.js"></script>
    <script src="app.js"></script>
    
    <!-- Service Worker Registration - FIXED -->
    <script>
        // Suppress WebSocket connection errors from development tools
        const originalConsoleError = console.error;
        const originalConsoleLog = console.log;
        
        console.error = function(...args) {
            const message = args.join(' ');
            // Suppress WebSocket connection errors and related development tool errors
            if (message.includes('WebSocket connection to') && 
                (message.includes('failed') || message.includes('closed'))) {
                return; // Suppress WebSocket connection errors
            }
            return originalConsoleError.apply(console, args);
        };
        
        console.log = function(...args) {
            const message = args.join(' ');
            // Suppress WebSocket connection errors that appear in console.log
            if (message.includes('WebSocket connection to') && 
                (message.includes('failed') || message.includes('closed'))) {
                return; // Suppress WebSocket connection errors
            }
            return originalConsoleLog.apply(console, args);
        };
        
        // Only register service worker if running on http/https (not file://)
        if ('serviceWorker' in navigator && window.location.protocol !== 'file:') {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => {
                        console.log('âœ… Service Worker Registered', reg.scope);
                    })
                    .catch(err => {
                        console.log('âŒ Service Worker Registration Failed', err);
                    });
            });
        } else if (window.location.protocol === 'file:') {
            console.log('âš ï¸ Service Worker not registered (file:// protocol)');
            console.log('ğŸ“Œ Run on local server for full PWA features:');
            console.log('   python -m http.server 8000');
            console.log('   Then open: http://localhost:8000');
        }
    </script>
    
    <!-- Load Verification -->
    <script>
        console.log('=== SCRIPT LOAD CHECK ===');
        console.log('Chart.js loaded:', typeof Chart !== 'undefined');
        console.log('conversion.js loaded:', typeof getCurrentNepaliDate !== 'undefined');
        console.log('db.js loaded:', typeof initDB !== 'undefined');
        console.log('charts.js loaded:', typeof renderTrendChart !== 'undefined');
        console.log('budget.js loaded:', typeof updateBudgetOverview !== 'undefined');
        console.log('insurance.js loaded:', typeof showInsuranceForm !== 'undefined');
        console.log('vehicle.js loaded:', typeof showVehicleForm !== 'undefined');
        console.log('subscription.js loaded:', typeof showSubscriptionForm !== 'undefined');
        console.log('custom.js loaded:', typeof showCustomTypeForm !== 'undefined');
        console.log('app.js loaded:', typeof renderCalendar !== 'undefined');
        console.log('=== END LOAD CHECK ===');
    </script>

    
    <!-- Developer Footer -->
    <footer class="developer-footer">
        <div class="developer-info">
            <div class="app-details">
                <span class="app-name">Nepali Calendar 2082â€“2092</span>
                <span class="version">v2.0.0</span>
            </div>
            <div class="developer-details">
                <span class="developer">Developed by: Santosh Phuyal</span>
                <span class="contact">ğŸ“§ hisantoshphuyal@gmail.com</span>
            </div>
        </div>
    </footer>
</body>
</html>
